<!DOCTYPE html>
<html>
	<head>

		
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- CSS styles integrated here -->
		<style>
			* {
				box-sizing: border-box;
				padding: 0;	
				margin: 0;
				font-family: 'Poppins', sans-serif;
				font-size: 18px;
			}
			body {
				height:;
				/*display: flex;*/
				align-items: center;
				justify-content: center;
			}
			.container {
				/*width: 500px;*/
				padding: 30px;
				border: 1px solid #ffffff;
				border-radius: 20px;
				background-color: #3d1307;
			}

			h4 {
				margin-bottom: 10px;
				font-size: 30px;
				color: white;
			}

			h5 {
				text-align: center;
				margin-bottom: 40px;
				font-size: 40px;
				color: rgb(204, 157, 157);
			}
			input {
				/*width: 100%;*/
				padding: 5px;
				margin-bottom: 25px;
			}
			textarea {
				width: 90%;
				padding: 10px;
				
			}
			select {
				margin-bottom: 10px;
			}

			table {
			width: 100%;
			border-collapse: collapse; /* Ensures borders are combined neatly */
			margin-top: 20px; /* Adds space between form and table */
			}

			tr, th, td {
			border: 2px solid #ccc; /* Adds border to all table rows and cells */
			padding: 10px; /* Adds some padding inside cells */
			text-align: left; /* Aligns text to the left */
			}

			th {
			background-color: #f4f4f4; /* Optional: Light background for table header */
			color: #333; /* Dark text color for better readability */
			}
			#submit {
				border: none;
				background-color: orangered;
				color: white;
				width: 200px;
				margin-top: 10px;
				border-radius: 5px;
			}
			#submit:hover {
				background-color: #333333;
			}
			#success-message {
            display: none; /* Initially hidden */
            background-color: rgb(223, 182, 0);
			color: rgb(255, 255, 255);
			border: none;
			width: 200px;
			margin-top: 10px;
			border-radius: 5px;
      
		</style>
	</head>
		
	<body>
		
		<div class="container">
			<form method="post" action="https://script.google.com/macros/s/AKfycbwK_NXmST1QLTHyHzm6c5gL-eTAQoL6PoGJHH_A1bibzxRB8UjaCbBnBp-GJnGhMbyX/exec" name="QMS-HTML">
				<h5>Radio MGIRI 90.4FM<h5></h5>
				<h4>Get Quotation On Your Email<h4>
				<input type="text" name="Name" placeholder="Full Name"required>
				<input type="text" name="Address" placeholder="Address"required>
				<input type="number" name="Number" placeholder="Mobile Number"required>
				<input type="email" name="Email" placeholder="Email"required>
				<br>
				<input type="number" name="sec" placeholder="Number of seconds"required>
                <input type="number" name="slots" placeholder="Number of Slots per Day"required>
                <input type="number" name="day" placeholder="Number of Days"required>
				<br>
				<textarea name="message" rows="3" placeholder="Message or Comment"></textarea>
				<input type="submit" value="Submit" id="submit"> <div id="success-message">Quotation Sent. Please Check Your Email</div>         		
			</form>
            <br><div id="success-message">Quotation Sent. Please Chack The Email or sent box</div>                                                                                          
			<button type="button" onclick="window.open('https://docs.google.com/spreadsheets/d/1WMgzesYXdpmRN_-3a7WjhYGZGwa2xPfISnTy8VdcFL8/edit?usp=sharing')">View Queries </button>
			<br>
			<br>
			<button type="button" onclick="window.open('https://sites.google.com/view/radiomgirioffice/quotation', '_blank')">Get Quotation</button>
			
			<br><br><br><br>
			&nbsp &nbspAdvertisement Calculator
			<br><br>

			<form onsubmit="handleSubmit(event)">
				<label for="sec">Seconds per slot:</label>
				<input type="number" id="sec" name="sec"><br><br>
				<label for="days">Number of days:</label>
				<input type="number" id="days" name="days"><br><br>
				<label for="slots">Number of slots per day:</label>
				<input type="number" id="slots" name="slots"><br><br>
				<input type="submit" value="Calculate Quotation">
				<h2 style="text-align: center; font-style: italic; color: rgb(167, 161, 161);">Developed by Mahatma Gandhi Institute for Rural Industrialization</h2>
				</form>
			  <div id="output"></div>
		</div> 

		<!-- JavaScript code integrated here -->
		<script>
			const scriptURL = 'https://script.google.com/macros/s/AKfycbwK_NXmST1QLTHyHzm6c5gL-eTAQoL6PoGJHH_A1bibzxRB8UjaCbBnBp-GJnGhMbyX/exec';
			const form = document.forms['QMS-HTML'];
			const successMessage = document.getElementById('success-message');

form.addEventListener('submit', e => {
e.preventDefault();  // Prevent default form submission

// Show the loading message
successMessage.style.display = 'block';  
successMessage.innerText = 'Submitting...'; // Change to loading message

fetch(scriptURL, { method: 'POST', body: new FormData(form) })
	.then(response => {
		if (response.ok) {
			// Show success message
			successMessage.innerText = 'Form Submitted Successfully!';
			form.reset();  // Optionally reset the form fields
		} else {
			// Show error if the form submission fails
			successMessage.innerText = 'Failed to submit the form. Please try again.';
		}
		// Hide message after 5 seconds
		setTimeout(() => {
			successMessage.style.display = 'none';
		}, 5000);
	})
	.catch(error => {
		successMessage.innerText = 'Error! Please try again.';
		console.error('Error!', error.message);
		// Hide message after 5 seconds
		setTimeout(() => {
			successMessage.style.display = 'none';
		}, 5000);
	});
});
function calculateQuotation(totalSec) {
          var adCost = totalSec * 7.40;
          var adGST = adCost * 0.18;
          var finalCost = adCost + adGST;
          return finalCost.toFixed(2);
        }
        function handleSubmit(event) {
          event.preventDefault();
          var sec = document.getElementById("sec").value;
          var days = document.getElementById("days").value;
          var slots = document.getElementById("slots").value;
          var totalSec = sec *  days * slots
          var quotationAmount = calculateQuotation(totalSec);
          var outputTable = "<table>";
          outputTable += "<tr><th>Description</th><th>Value</th></tr>";
          outputTable += "<tr><td>Seconds per slot</td><td>" + sec + "</td></tr>";
          outputTable += "<tr><td>Number of days</td><td>" + days + "</td></tr>";
          outputTable += "<tr><td>Number of slots per day</td><td>" + slots + "</td></tr>";
          outputTable += "<tr><td>Total seconds</td><td>" + totalSec + "</td></tr>";
          outputTable += "<tr><td>Ad cost</td><td>₹" + (totalSec * 7.40).toFixed(2) + "</td></tr>";
          outputTable += "<tr><td>GST</td><td>₹" + ((totalSec * 7.40) * 0.18).toFixed(2) + "</td></tr>";
          outputTable += "<tr><td>Total cost</td><td>₹" + quotationAmount + "</td></tr>";
          outputTable += "</table>";
          document.getElementById("output").innerHTML = outputTable;
        }
		</script>
	</body>
</html>
